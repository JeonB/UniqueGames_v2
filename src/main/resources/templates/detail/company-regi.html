<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Unique Games</title>
  <link rel="stylesheet" th:href="@{/css/main.css}">
  <link rel="stylesheet" th:href="@{/css/company-regi.css}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>

<body>
<!--header-->
<div th:replace="~{/main/header::headerFragment}"></div>
<section id="top-bg">
  <div id="base-layer">
    <div id="top-bg-textarea">
      <p id="top-title">회사(팀) 소개글</p>
      <p id="top-subtitle">#등록</p>
    </div>
  </div>
</section>
<div id="content">
  <div id="board-write">
    <form  id="editorForm">
      <div class="Frame3" style="width: 1100px; height: 612px; position: relative; margin:auto">
        <div class="Board" style="left: 0px; top: 0px; position: absolute; color: #2B2B2B; font-size: 24px; font-family: YouandiModern; font-weight: 400; word-wrap: break-word">Game_registration</div>
        <div class="485" style="width: 760px; height: 55px; left: 0px; top: 47px; position: absolute">
          <div class="Vector" style="width: 760px; height: 55px; left: 0px; top: 0px; position: absolute; background: white; border: 0.50px #DDDDDD solid"></div>
          <input class="Vector" type="text" name="name" th:value="${company?.name}" readonly style="width: 600px; height: 39px; left: 113px; top: 8.50px; position: absolute; background: white; border: 0.50px #DDDDDD solid">
          <div style="left: 24px; top: 17px; position: absolute; color: black; font-size: 16px; font-family: YouandiModern; font-weight: 400; word-wrap: break-word">회사명</div>
        </div>
        <div class="487" style="width: 760px; height: 55px; left: 0px; top: 102px; position: absolute">
          <div class="Vector" style="width: 760px; height: 55px; left: 0px; top: 0px; position: absolute; background: white; border: 0.50px #DDDDDD solid"></div>
          <input class="Vector" type="text" name="title" th:value="${intro?.title}" style="width: 600px; height: 39px; left: 113px; top: 8.50px; position: absolute; background: white; border: 0.50px #DDDDDD solid">
          <div style="left: 24px; top: 17px; position: absolute; color: black; font-size: 16px; font-family: YouandiModern; font-weight: 400; word-wrap: break-word">제목</div>
        </div>
        <div class="488" style="width: 760px; height: 55px; left: 0px; top: 457px; position: absolute">
          <div class="Vector" style="width: 760px; height: 55px; left: 0px; top: 0px; position: absolute; background: white; border: 0.50px #DDDDDD solid"></div>
          <div id="filename" class="Vector" style="width: 600px; height: 40px; left: 113px; top: 8px; position: absolute; background: white; border: 0.50px #DDDDDD solid"></div>
          <div style="left: 24px; top: 17px; position: absolute; color: black; font-size: 16px; font-family: YouandiModern; font-weight: 400; word-wrap: break-word">썸네일</div>

          <!--파일 업로드 -->
          <input id="fileUploadInput" type="file" name ="uploadFile" accept="image/*" style="display: none">

        </div>
        <div class="486" style="width: 760px; height: 299px; left: 0px; top: 157px; position: absolute">
          <div class="Vector" style="width: 760px; height: 299px; left: 0px; top: 0px; position: absolute; background: white; border: 0.50px #DDDDDD solid"></div>
            <textarea class="Vector"  name="content" style="width: 600px; height: 268px; left: 113px; top: 7.50px; position: absolute; background: white; border: 0.50px #DDDDDD solid" th:text="${intro?.content}"></textarea>
          <div style="left: 24px; top: 17px; position: absolute; color: black; font-size: 16px; font-family: YouandiModern; font-weight: 400; word-wrap: break-word">소개글</div>
        </div>
        <div class="469" style="width: 1100px; height: 2px; left: 0px; top: 46px; position: absolute; background: #393939"></div>
        <div class="505" style="width: 760px; height: 2px; left: 0px; top: 455px; position: absolute; background: #393939"></div>
        <div class="506" style="width: 1100px; height: 2px; left: 0px; top: 511px; position: absolute; background: #393939"></div>
        <div class="Group24" style="width: 340px; height: 463px; left: 760px; top: 49px; position: absolute">
          <div class="Vector" style="width: 340px; height: 463px; left: 0px; top: 0px; position: absolute; background: white; border: 0.50px #DDDDDD solid"></div>
          <div class="Group23" style="width: 280px; height: 305px; left: 30px; top: 30px; position: absolute">
            <img class="Rectangle50" id="addImg" style="width: 280px; height: 160px; left: 0px; top: 0px; position: absolute; box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.10)" th:src="@{/images/btn-numberPlus-normal.png}">
          </div>
        </div>
        <div class="Group21" style="width: 300px; height: 60px; left: 200px; top: 552px; position: absolute">
          <button id="editorFormSubmit" class="526" style="width: 200px; height: 60px; left: 50px; top: 0px; position: absolute; background: linear-gradient(45deg, #682CAD 0%, #2FC0CC 100%); cursor: pointer" type="button"> <div th:text="${#strings.isEmpty(intro?.title)} ? '저장':'수정' " style="left: 78px; top: 19px; position: absolute; color: white; font-size: 20px; font-family: YouandiModern; font-weight: 400; word-wrap: break-word">등록</div></button>

        </div>
      </div>
      <th:block th:if="${intro != null}">
        <input type="hidden" name="id" th:value="${intro.id}">
      </th:block>

    </form>
  </div>
</div>
<!--footer-->
<div th:replace="~{main/footer :: footerFragment}"></div>

<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.12.4.min.js"></script>
<script>
    $("#editorFormSubmit").click(function(event){

      let form = $("#editorForm")[0];
      let formData = new FormData(form);

      let action = "/insertIntro";
      if($(location).attr('href').includes("/editIntro") === true){
        action = "/editIntro";
      }

      $.ajax({
        url: action,
        type: "POST",
        data: formData,
        processData: false, // jQuery가 데이터를 프로세싱하는 것을 방지
        contentType: false, // jQuery가 데이터 타입을 설정하는 것을 방지
        success: function(result) {
          console.log(result);
          location.href="../getIntroList";
        },
        error: function(jqXHR, textStatus, errorThrown) {
          console.error("Error submitting the form: " + textStatus, errorThrown);
        }
      });
    });


    $("#addImg").on("click", function(){
      $("#fileUploadInput").click();

      $('#fileUploadInput').on('change', function() {
        const input = this;
        if (input.files && input.files[0]) {
          const reader = new FileReader();

          // FileReader의 로드 이벤트를 사용하여 미리보기 이미지를 변경
          reader.onload = function(e) {
            $('#addImg').attr('src', e.target.result);
          };

          reader.readAsDataURL(input.files[0]);
        }
        // 업로드된 파일의 이름을 추출하여 출력
        const filename = $(this).val().split('\\').pop();
        $('#filename').text(filename);
      });
    });
</script>

</body>

</html>